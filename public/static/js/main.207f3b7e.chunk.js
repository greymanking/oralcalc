(this.webpackJsonporalcalc=this.webpackJsonporalcalc||[]).push([[0],{19:function(module,__webpack_exports__,__webpack_require__){"use strict";var D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4),D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5),D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7),D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6),D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1),D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__),TaskZone=function(_React$PureComponent){function TaskZone(e){var t;return Object(D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,TaskZone),(t=Object(D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__.a)(this,Object(D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__.a)(TaskZone).call(this,e))).starttime=0,t.state={pos:0,answer:"\u770b\u7b54\u6848"},t.showAnswer=t.showAnswer.bind(Object(D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__.a)(t)),t.moveNext=t.moveNext.bind(Object(D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__.a)(t)),t.commitRec=t.commitRec.bind(Object(D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__.a)(t)),t.onKeyPressed=t.onKeyPressed.bind(Object(D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__.a)(t)),t}return Object(D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__.a)(TaskZone,_React$PureComponent),Object(D_js_oralcalc_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(TaskZone,[{key:"componentDidMount",value:function(){this.starttime=(new Date).getTime(),this.block.focus()}},{key:"showAnswer",value:function showAnswer(){this.setState({answer:"\u7b54\u6848\uff1a"+eval(this.props.questions[this.state.pos])})}},{key:"moveNext",value:function(){this.setState({answer:"\u770b\u7b54\u6848",pos:this.state.pos+1})}},{key:"commitRec",value:function(){var e=(new Date).getTime();this.props.finish({key:this.props.reckey,datems:e,secs:Math.round((e-this.starttime)/1e3)})}},{key:"onKeyPressed",value:function(e){13===e.which&&(this.state.pos===this.props.questions.length-1?this.commitRec():this.moveNext())}},{key:"render",value:function(){var e=this,t=this.state.pos===this.props.questions.length-1?react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("button",{onClick:this.commitRec},"\u7ed3  \u675f"):react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("button",{onClick:this.moveNext},"\u4e0b\u4e00\u9898");return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{tabindex:"3",onKeyPressCapture:this.onKeyPressed,ref:function(t){return e.block=t}},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"header"},"\u7b2c",this.state.pos+1,"\u9898"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"content"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"extra1"},this.props.questions[this.state.pos]),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"anspane",onClick:this.showAnswer},this.state.answer)),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"btnspane"},t))}}]),TaskZone}(react__WEBPACK_IMPORTED_MODULE_6___default.a.PureComponent);__webpack_exports__.a=TaskZone},21:function(e,t,a){e.exports=a(45)},26:function(e,t,a){},27:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var s=a(0),_=a.n(s),n=a(18),r=a.n(n),i=(a(26),a(20)),c=a(4),o=a(5),l=a(7),u=a(6),m=a(1),h=a(8),d=(a(27),a(19)),b=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={classes:"msg"},a.onAnimEnd=a.onAnimEnd.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"onAnimEnd",value:function(){this.setState({classes:"msg"})}},{key:"componentWillReceiveProps",value:function(e){if(this.props.settings.time!==e.settings.time){var t="msg";2===e.settings.type?t+=" error-msg-color runanimation":1===e.settings.type&&(t+=" normal-msg-color runanimation"),this.setState({classes:t})}}},{key:"render",value:function(){return _.a.createElement("div",{className:this.state.classes,onAnimationEnd:this.onAnimEnd},this.props.settings.text)}}]),t}(_.a.PureComponent),p=a(3),E=a.n(p);function k(e){var t=Math.floor(e/60),a=0===t?"":t+"\u5206",s=e-60*t;return a+=(s<10?"0":"")+s+"\u79d2"}function f(e){for(var t=[],a=0;a<e.itemsList.length;a++){var s=e.itemsList[a];t.push(_.a.createElement("li",{key:s.key,index:a,className:a==e.activeIndex?"highlightcolor":"",onClick:function(t){return e.sel(t.target.getAttribute("index"))}},s.title))}return _.a.createElement("div",null,_.a.createElement("div",{className:"header"},"\u5f00\u59cb"),_.a.createElement("ul",{className:"content"}," ",t),_.a.createElement("div",{className:"btnspane"},_.a.createElement("button",{disabled:!e.canOperate,onClick:e.start},"\u51fa\u3000\u53d1"),_.a.createElement("button",{disabled:!e.canOperate,onClick:e.showRecs},"\u770b\u6210\u7ee9")))}function v(e){var t=e.list.map((function(e){return _.a.createElement("tr",{key:e.datems},_.a.createElement("td",null,function(e,t){var a,s=new Date;s.setTime(e);var _={"Y+":s.getFullYear().toString(),"m+":(s.getMonth()+1).toString(),"d+":s.getDate().toString(),"H+":s.getHours().toString(),"M+":s.getMinutes().toString(),"S+":s.getSeconds().toString()};for(var n in _)(a=new RegExp("("+n+")").exec(t))&&(t=t.replace(a[1],1===a[1].length?_[n]:_[n].padStart(a[1].length,"0")));return t}(e.datems,"YYYY\u5e74mm\u6708dd\u65e5 HH:MM")),_.a.createElement("td",null,k(e.secs)))}));return _.a.createElement("div",null,_.a.createElement("div",{className:"header"},"\u6210\u7ee9"),_.a.createElement("div",{className:"content"},_.a.createElement("div",{className:"heading"},e.title),_.a.createElement("table",null,_.a.createElement("tbody",null,t))),_.a.createElement("div",{className:"btnspane"},_.a.createElement("button",{onClick:e.back},"\u8fd4  \u56de")))}function g(e){return _.a.createElement("div",null,_.a.createElement("div",{className:"header"},"\u6210\u7ee9"),_.a.createElement("div",{className:"content"},_.a.createElement("div",{className:"extra2"},e.text)),_.a.createElement("div",{className:"btnspane"},_.a.createElement("button",{onClick:e.restart},"\u518d\u4e00\u6b21")))}var D=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).tasks=[],a.recsCache={},a.questionsCache={},a.usedTimeCache=0,a.state={stage:-1,activeTaskIndex:0,fetchingData:!0,message:{type:0,text:"n/a",time:0}},a.setActiveTask=a.setActiveTask.bind(Object(m.a)(a)),a.showRecs=a.showRecs.bind(Object(m.a)(a)),a.backToTaskList=a.backToTaskList.bind(Object(m.a)(a)),a.startWork=a.startWork.bind(Object(m.a)(a)),a.finishWork=a.finishWork.bind(Object(m.a)(a)),a.submitRec=a.submitRec.bind(Object(m.a)(a)),a.restartWork=a.restartWork.bind(Object(m.a)(a)),a.showMessage=a.showMessage.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"showMessage",value:function(e,t){var a=(new Date).getTime();this.setState({message:{type:t,text:e,time:a}})}},{key:"componentDidMount",value:function(){var e=this;E.a.defaults.retry=3,E.a.defaults.retryDelay=500,E.a.interceptors.response.use(void 0,(function(e){var t=e.config;return t&&t.retry?(t.__retryCount=t.__retryCount||0,console.log(t.__retryCount,t.retry),t.__retryCount>=t.retry?Promise.reject(e):(t.__retryCount+=1,new Promise((function(e){setTimeout((function(){e()}),t.retryDelay||1)})).then((function(){return E()(t)})))):Promise.reject(e)}));for(var t=0;t<localStorage.length;t++){var a=localStorage.key(t);if(a.startsWith("frs")){var s={},_=a.substr(3).split("_",2),n=Object(i.a)(_,2),r=n[0],c=n[1];s.key=r,s.datems=parseInt(c),s.secs=parseInt(localStorage[a]),this.submitRec(s)}}E.a.get("/dataindex.json").then((function(t){e.tasks=t.data,e.setState({fetchingData:!1})})).catch((function(t){e.showMessage(t.toString(),2)}))}},{key:"setActiveTask",value:function(e){this.state.fetchingData||this.setState({activeTaskIndex:parseInt(e)})}},{key:"showRecs",value:function(){var e=this;if(!this.state.fetchingData){this.setState({fetchingData:!0});var t=this.tasks[this.state.activeTaskIndex];E.a.get("/recs/"+t.key).then((function(a){e.recsCache[t.key]=a.data,e.setState({stage:-2,fetchingData:!1})})).catch((function(t){e.showMessage(t.toString(),2),e.setState({fetchingData:!1})}))}}},{key:"backToTaskList",value:function(){this.setState({stage:-1})}},{key:"startWork",value:function(){var e=this;if(!this.state.fetchingData){this.setState({fetchingData:!0});var t=this.tasks[this.state.activeTaskIndex].key;E.a.get("/data/"+t+".json").then((function(a){e.questionsCache[t]=a.data,e.setState({stage:0,fetchingData:!1})})).catch((function(t){e.showMessage(t.toString(),2),e.setState({fetchingData:!1})}))}}},{key:"finishWork",value:function(e){this.setState({stage:1}),this.usedTimeCache=e.secs,this.submitRec(e)}},{key:"submitRec",value:function(e){var t=this;E.a.post("/rec/",e,{retry:1,retryDelay:500}).then((function(a){var s="\u63d0\u4ea4\u6210\u7ee9"+(a.data.addrec?"\u6210\u529f":"\u5931\u8d25");t.showMessage(s,a.data.addrec?1:2);var _="frs"+e.key+"_"+e.datems;localStorage.getItem(_)&&localStorage.removeItem(_)})).catch((function(a){localStorage.setItem("frs"+e.key+"_"+e.datems,e.secs),t.showMessage(a.toString(),2)}))}},{key:"restartWork",value:function(){this.setState({stage:-1})}},{key:"render",value:function(){var e=null;switch(this.state.stage){case-1:e=_.a.createElement(f,{itemsList:this.tasks,activeIndex:this.state.activeTaskIndex,sel:this.setActiveTask,start:this.startWork,showRecs:this.showRecs,canOperate:!this.state.fetchingData});break;case-2:var t=this.tasks[this.state.activeTaskIndex];e=_.a.createElement(v,{title:t.title,list:this.recsCache[t.key],back:this.backToTaskList});break;case 0:var a=this.tasks[this.state.activeTaskIndex];e=_.a.createElement(d.a,{questions:this.questionsCache[a.key],finish:this.finishWork,reckey:a.key});break;case 1:e=_.a.createElement(g,{text:k(this.usedTimeCache),restart:this.restartWork})}return _.a.createElement("div",{id:"app"},_.a.createElement(b,{settings:this.state.message}),e)}}]),t}(_.a.PureComponent);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(_.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.207f3b7e.chunk.js.map